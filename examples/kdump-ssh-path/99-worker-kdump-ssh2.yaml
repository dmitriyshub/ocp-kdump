# Generated by Butane; do not edit
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: worker
  name: 99-worker-kdump
spec:
  config:
    ignition:
      version: 3.2.0
    storage:
      files:
        - contents:
            compression: ""
            source: data:,-----BEGIN%20OPENSSH%20PRIVATE%20KEY-----%0ASSH_PRIVATE_KEY_CONTENT%0A-----END%20OPENSSH%20PRIVATE%20KEY-----%0A
          mode: 256
          overwrite: true
          path: /var/usrlocal/.ssh/kdump_id_rsa
        - contents:
            compression: ""
            source: data:,SSH_PUBLIC_KEY_CONTENT%0A
          mode: 256
          overwrite: true
          path: /var/usrlocal/.ssh/kdump_id_rsa.pub
        - contents:
            compression: ""
            source: data:,Host%20192.168.12.113%0A%20%20%20%20%20%20StrictHostKeyChecking%20no%0A
          mode: 420
          overwrite: true
          path: /root/.ssh/config
        - contents:
            compression: ""
            source: data:,ssh%20root%40192.168.12.113%0Asshkey%20%2Fvar%2Fusrlocal%2F.ssh%2Fkdump_id_rsa%0Apath%20%2Fvar%2Fcrash%0Acore_collector%20makedumpfile%20-F%20-l%20--message-level%207%20-d%2031%0Adefault%20shell%0A
          mode: 420
          overwrite: true
          path: /etc/kdump.conf
        - contents:
            compression: gzip
            source: data:;base64,H4sIAAAAAAAC/2TQQWsCMRAF4Lu/Yti7i7bnHEQXEbsqlpbeQjaZzQaSTJwk29ZfXyjYS2/f6fHeO+7e+ovcnvt+c9q9HE6dvHb9+b0TzVQtJmUxw5/ukH0dpMGhWrhVhwU8WTnUUXqMkD8dFT80i/+hm8ulO+1E4/iWyHuILHWqWayBMWORBmenMYO2TDVJ47IaPIqAgfgbgkZB4wixBvWLanBu9eS8YYzLoL7EEyQVnRbrFTBRGb2yWUQalfOgdHIykgwYJirJVwuFVcxJMcYiH/NExBkZIs1BE6MxMGEujy7Apo1Y2uICUi2tVswOWTyvYKBoXLTN4th9dFu5ue5fRbPMjx8O/V40c/Au1nuz+AkAAP//jAqgO3EBAAA=
          mode: 420
          overwrite: true
          path: /etc/sysconfig/kdump
    systemd:
      units:
        - contents: |
            [Unit]
            Description=Execute ssh-copy-id for enabling kdump.service
            Wants=network-online.target sshd.service rpc-statd.service crio.service
            Before=kdump.service
            After=network-online.target sshd.service rpc-statd.service crio.service
            [Service]
            Type=oneshot
            ExecStart=ssh-copy-id -i /var/usrlocal/.ssh/kdump_id_rsa -o StrictHostKeyChecking=no  root@192.168.12.113
            [Install]
            WantedBy=multi-user.target
          enabled: true
          name: kdumpctl-propagate-oneshot.service
        - enabled: true
          name: kdump.service
  kernelArguments:
    - crashkernel=512M
